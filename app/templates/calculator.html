
<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Arithmetic API – Calculatrice</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 40px; }
    .card { max-width: 520px; padding: 24px; border-radius: 16px; box-shadow: 0 8px 30px rgba(0,0,0,0.08); border: 1px solid #eee; }
    h1 { margin-top: 0; font-size: 22px; }
    label { display:block; margin: 12px 0 6px; font-weight: 600; }
    input, select { width: 100%; padding: 10px 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px; }
    button { margin-top: 16px; padding: 10px 14px; border: 0; border-radius: 10px; background: #0d6efd; color: white; font-weight: 600; cursor: pointer; }
    button:disabled { opacity: .6; cursor: not-allowed; }
    .result { margin-top: 16px; padding: 12px; border-radius: 10px; background: #f8f9fa; border: 1px dashed #ccc; }
    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    .hint { color:#666; font-size: 14px; margin-top: 8px; }
    .ok { color: #0a7c2f; font-weight: 700; }
    .err { color: #b00020; font-weight: 700; }
  </style>
</head>
<body>
  <div class="card">
    <h1>Calculatrice (via l'API)</h1>
    <div class="row">
      <div>
        <label for="a">Nombre A</label>
        <input id="a" type="number" step="any" value="10">
      </div>
      <div>
        <label for="b">Nombre B</label>
        <input id="b" type="number" step="any" value="5">
      </div>
    </div>

    <label for="op">Opération</label>
    <select id="op">
      <option value="add">Addition</option>
      <option value="subtract">Soustraction</option>
      <option value="multiply">Multiplication</option>
      <option value="divide">Division</option>
    </select>

    <button id="btn">Calculer</button>

    <div class="result" id="out">
      <div class="hint">Résultat affiché ici…</div>
    </div>

    <div class="hint">
      Les endpoints API sont aussi accessibles directement : <code>/add</code>, <code>/subtract</code>, <code>/multiply</code>, <code>/divide</code>.
    </div>
  </div>

  <script>
    const btn = document.getElementById('btn');
    const out = document.getElementById('out');
    const a = document.getElementById('a');
    const b = document.getElementById('b');
    const op = document.getElementById('op');

    async function callApi() {
      btn.disabled = true;
      out.innerHTML = '<div class="hint">Calcul en cours…</div>';

      const endpoint = `/${op.value}`;
      try {
        const resp = await fetch(endpoint, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ a: a.value, b: b.value })
        });

        const data = await resp.json();
        if (resp.ok) {
          out.innerHTML = `<div class="ok">✅ ${data.operation}(${data.a}, ${data.b}) = <strong>${data.result}</strong></div>`;
        } else {
          out.innerHTML = `<div class="err">❌ Erreur ${data.error || ''}: ${data.message || JSON.stringify(data.details || data)}</div>`;
        }
      } catch (e) {
        out.innerHTML = `<div class="err">❌ Erreur réseau: ${e}</div>`;
      } finally {
        btn.disabled = false;
      }
    }

    btn.addEventListener('click', callApi);
  </script>
</body>
</html>
